<script>
const PIN = "4821"; // Investor PIN

function submitDecision(status) {
  const userPin = prompt("Enter Investor PIN:");

  if (!userPin) return alert("PIN required");

  let investorCode = "Failed";
  if (userPin === PIN) investorCode = "Verified";

  const ref = document.getElementById("dealRef").value;
  const notes = document.getElementById("note").value;

  fetch("https://script.google.com/macros/s/AKfycbwMqFyO3pVZbvOfhSt1DMUObfHAeyqNBxTlLZjXOMdqJo6xc8DzILMec_YVjrXbjo8/exec", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      ref: ref,
      status: status,
      notes: notes,
      code: investorCode
    })
  })
  .then(r => r.text())
  .then(msg => alert("Decision submitted to Quintrin."))
  .catch(err => alert("Submission failed: " + err));
}
</script>

<button onclick="submitDecision('Approved')">Approve</button>
<button onclick="submitDecision('Rejected')">Reject</button>
<button onclick="submitDecision('Clarification Required')">Clarify</button>
